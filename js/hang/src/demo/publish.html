<!doctype html>
<html lang="en" class="dark">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MoQ Demo</title>

	<link rel="stylesheet" href="index.css">
	<link rel="icon" type="image/svg+xml" href="/favicon.svg">
</head>

<body>
	<!-- Show if this browser supports everything we need. -->
	<hang-support role="publish"></hang-support>

	<!-- Use the included Web Component to render a preview and simple controls. -->
	<hang-publish audio video url="http://localhost:4443/" broadcast="demo/me" controls>
		<!-- It's optional to provide a video element to preview the outgoing media. -->
		<video style="max-width: 100%; height: auto; border-radius: 4px; margin: 0 auto;" muted autoplay></video>
	</hang-publish>

	<h3>Other demos:</h3>
	<ul>
		<li><a href="index.html" target="_blank" rel="noreferrer" id="watch">Watch your broadcast: <span
					id="watch-name"></span></a></li>
	</ul>

	<h3>Tips:</h3>
	<p>
		This page creates a broadcast called `demo/me` by default.
		You can watch it with the <a href="index.html?path=demo/me">watch demo</a>.
		You can also use <a href="index.html?path=demo/notme">query parameters</a> to create a different broadcaster.
	</p>
	<p>
		Reusing the same broadcast path means viewers will automatically reconnect to the new session.
		Try reloading the page and broadcasting again; viewers will automatically reconnect!
	</p>
	<p>
		Media only flows over the network when requested!
		Connecting to a relay means the broadcast is advertised as available, but nothing is transferred until there's
		at least one viewer per track.
		If there's multiple viewers, the relay will fan out the media to all of them.
		<b>TODO</b>: We still encode media even when there are no viewers, but somebody should improve this!
	</p>
	<p>
		You can create a broadcaster via the provided <code class="language-html">&lt;hang-publish&gt;</code> <a
			href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components">Web Component</a>.
		Either modify HTML attributes like <code class="language-html">&lt;moq-publish device="camera" /&gt;</code>
		or access the element's Javascript API:
	<pre><code class="language-typescript">const publish = document.getElementById("publish");
publish.lib.device = "camera";</code></pre>

	And of course you can use the Javascript API directly instead of the Web Component.
	It's a bit more complicated and subject to change, but it gives you more control.
	</p>
</body>

<script type="module" src="publish.ts"></script>

</html>